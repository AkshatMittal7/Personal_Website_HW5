<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Akshat Mittal - Contact</title>
    <meta name="description" content="Contact page for Akshat Mittal.">

    <!-- Custom Font with Fallback (Requirement 3) -->
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&display=swap" rel="stylesheet">

    <style>
        /* CSS Variables with Fallback (Requirement 2) */
        :root {
            --primary-color: color(display-p3 0.2 0.3 0.7 / 1);
            --font-size-base: 16px;
        }

        body {
            font-family: 'Roboto', sans-serif; /* Custom font with fallback */
            font-size: var(--font-size-base, 16px); /* Using CSS Variable with Fallback */
            border: 1px solid black;
        }

        header, footer {
            background-color: var(--primary-color);
            color: white;
            max-height: 20vh;
            padding: 1rem;
            text-align: center;
        }

        nav a {
            padding: 0.5rem 1rem;
            margin: 0.5rem;
            background-color: white;
            color: var(--primary-color);
            text-decoration: none;
            border-radius: 8px;
            transition: background-color 0.3s; /* Transitions (Requirement 6) */
        }

        nav a:hover {
            background-color: color-mix(in display-p3, var(--primary-color) 70%, yellow 30%);
        }

        main {
            padding: 2rem;
            display: flex; /* Flexbox for layout (Requirement 1) */
            flex-direction: column;
            gap: 2rem;
        }

        @keyframes pulse {
            0% {
                transform: scale(1);
            }
            50% {
                transform: scale(1.05);
            }
            100% {
                transform: scale(1);
            }
        }

        section:has(h2) {
            border: 2px solid #e74c3c;
        }

        header h1 {
            animation: pulse 5s infinite;
        }

        /* Media Query Example */
        @media screen and (min-width: 768px) {
            body {
                font-size: calc(var(--font-size-base) * 1.2); /* Using calc with CSS Variable */
            }
        }

        form {
            display: flex;
            flex-direction: column;
            gap: 1rem;
        }

        form label, form input, form textarea, form button {
            width: 100%;
            margin-top: 0.5rem;
        }

        form output {
            margin-top: 1rem;
            color: red;
        }

        .error-flash {
            animation: flash-error 0.3s;
        }

        @keyframes flash-error {
            50% { background-color: #ffcccc; }
        }

        :root {
        --background-color: #ffffff; /* white */
        --text-color: #000000; /* black */
        }

        /* Dark Theme Variables */
        [data-theme="dark"] {
            --background-color: #363537; /* dark gray */
            --text-color: #FAFAFA; /* off-white */
        }

        body {
            background-color: var(--background-color);
            color: var(--text-color);
            /* ... other styles ... */
        }

    </style>
</head>

<body>

    <noscript>
        <p>JavaScript is not enabled. The theme switcher is not available, and the default light theme is used.</p>
    </noscript>

    <header>
        <h1>Welcome to Akshat Mittal's Portfolio</h1>
        <nav>
            <a href="index.html">Home</a> |
            <a href="about.html">Resume</a> |
            <a href="portfolio.html">Portfolio</a> |
            <a href="contact.html">Contact</a>
        </nav>
        <button id="theme-toggle">Toggle Theme</button>
    </header>

    <main>
        <section>
            <h2>Contact Me</h2>
            <!--
            <form action="path_to_server_script" method="post">
                <label for="name">Name:</label>
                <input type="text" id="name" name="name">
                <label for="subject">Subject:</label>
                <input list="subjects" name="subject" id="subject">
                <datalist id="subjects">
                    <option value="Job Opportunity">
                    <option value="Collaboration">
                    <option value="General Query">
                </datalist>
                <label for="email">Email:</label>
                <input type="email" id="email" name="email">
                <label for="message">Message:</label>
                <textarea id="message" name="message"></textarea>
                <button type="submit">Submit</button>
            </form>
            -->
            <form action="https://httpbin.org/post" method="post" id="contactForm">
                <div class="form-group">
                    <label for="name">Name:</label>
                    <input type="text" id="name" name="name" required>
                    <output id="nameError" class="error-message"></output>
                    <output id="nameInfo" class="info-message"></output>
                </div>
                <div class="form-group">
                    <label for="email">Email:</label>
                    <input type="email" id="email" name="email" required>
                    <output id="emailError" class="error-message"></output>
                    <output id="emailInfo" class="info-message"></output>
                </div>
                <div class="form-group">
                    <label for="comments">Comments:</label>
                    <textarea id="comments" name="comments" required minlength="20" maxlength="500" pattern="[A-Za-z0-9\s.,!?'-]*"></textarea>
                    <output id="commentsError" class="error-message"></output>
                    <output id="commentsInfo" class="info-message"></output>
                </div>
                <input type="hidden" id="form-errors" name="form-errors" value="">
                <input type="hidden" name="possible_bot" value="true">
                <button type="submit">Submit</button>
            </form>
        </section>

        <section>
            <h2>Contact Details</h2>
            <table>
                <colgroup>
                    <col span="1" style="background-color:gray">
                    <col style="background-color:yellow">
                </colgroup>
                <tr>
                    <td>Email:</td>
                    <td><a href="mailto:a1mittal@ucsd.edu">a1mittal@ucsd.edu</a></td>
                </tr>
                <tr>
                    <td>Phone:</td>
                    <td>6199958469</td>
                </tr>
            </table>
        </section>

        <template id="my-template">
            <p>This is a template. It's not rendered on the page unless activated via JavaScript.</p>
        </template>

    </main>

    <footer>
        <p>Connect with me on <a href="https://www.linkedin.com/in/akshatmittal15/">LinkedIn</a> or 
                    <a href="https://github.com/AkshatMittal7">GitHub</a>.</p>
        <p>Â© 2023 Akshat Mittal. All rights reserved.</p>
    </footer>

    <script>
        document.addEventListener('DOMContentLoaded', (event) => {
            const form = document.getElementById('contactForm');
            let formErrors = [];

            const email = document.getElementById('email');
            email.addEventListener('input', function(event) {
                if (email.validity.typeMismatch) {
                    email.setCustomValidity('Please enter a valid email address.');
                } else {
                    email.setCustomValidity('');
                }
            });

            const comments = document.getElementById('comments');
            comments.addEventListener('input', function(event) {
                const maxLength = comments.getAttribute('maxlength');
                const currentLength = comments.value.length;
                const remaining = maxLength - currentLength;
                const commentsInfo = document.getElementById('commentsInfo');

                commentsInfo.textContent = `${remaining} characters remaining`;

                if (remaining <= 10) {
                    commentsInfo.style.color = 'orange';
                } else {
                    commentsInfo.style.color = 'black';
                }

                if (remaining <= 0) {
                    commentsInfo.style.color = 'red';
                }
                
                const pattern = new RegExp(comments.getAttribute('pattern'));
                if (!pattern.test(comments.value)) {
                    comments.classList.add('error-flash');
                    setTimeout(() => comments.classList.remove('error-flash'), 1000);
                    document.getElementById('commentsError').textContent = 'Illegal character detected!';
                } else {
                    document.getElementById('commentsError').textContent = '';
                }
            });

            form.addEventListener('submit', function(event) {
                event.preventDefault();
                // Check validity on all form fields
                const elements = form.elements;
                for (let i = 0; i < elements.length; i++) {
                    console.log(elements[i].name, elements[i].validity);
                    if (!elements[i].checkValidity()) {
                        formErrors.push({
                            field: elements[i].name,
                            type: elements[i].validationMessage
                        });
                    }
                }

                console.log('Form Errors:', formErrors);

                document.getElementById('form-errors').value = JSON.stringify(formErrors);

                if (formErrors.length === 0) {
                    form.submit();
                }
            });
        });


        document.head.insertAdjacentHTML('beforeend', `<style>
            .error-flash {
                animation: flash-error 0.3s;
            }
            @keyframes flash-error {
                50% { background-color: #ffcccc; }
            }
        </style>`);

        document.addEventListener('DOMContentLoaded', (event) => {
        const themeToggle = document.getElementById('theme-toggle');
        const currentTheme = localStorage.getItem('theme') || 'light';

        if (currentTheme === 'dark') {
            document.documentElement.setAttribute('data-theme', 'dark');
        }

        themeToggle.addEventListener('click', () => {
            const theme = document.documentElement.getAttribute('data-theme');
            if (theme === 'dark') {
                document.documentElement.removeAttribute('data-theme');
                localStorage.setItem('theme', 'light');
            } else {
                document.documentElement.setAttribute('data-theme', 'dark');
                localStorage.setItem('theme', 'dark');
            }
        });
    });


    </script>

</body>
</html>

